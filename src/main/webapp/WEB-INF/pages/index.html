<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>拾刻</title>
    <meta name="viewport" content="initial-scale=1, maximum-scale=1">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="stylesheet" href="//g.alicdn.com/msui/sm/0.6.2/css/sm.min.css">
    <link rel="stylesheet" href="//g.alicdn.com/msui/sm/0.6.2/css/sm-extend.min.css">
    <link rel="apple-touch-icon-precomposed" href="/assets/img/apple-touch-icon-114x114.png">
    <link rel="stylesheet" href="${request.contextPath}/css/material-icon.css">
    <style type="text/css">
        body{font-family: Arial, Helvetica, sans-serif;}
        .infinite-scroll-preloader {
            margin-top:-20px;
        }
        .commentAvatarDiv{
            width: 50px;
            height: 50px;
            padding:0px;
            background: #ececec;
            border-radius:50px;
            box-shadow: 0px 0px 0px rgba(0,0,0,0.4);
            -moz-border-radius: 50px;
            -webkit-border-radius: 50px;
        }
        .commentAvatarImage{
            width:50px;
            height:50px;
            line-height: 0;	 /* remove line-height */
            display: inline-block;	/* circle wraps image */
            border-radius: 50%;	/* relative value */
            -moz-border-radius: 50%;
            -webkit-border-radius: 50%;
            transition: linear 0.25s;
        }
        .searchbar .search-input input {
            /* padding-left: 1.4rem;*/
            height: 1.5rem;
            border: 1px solid #c4c4c4;
            text-align: center;
            background-color: rgba(255, 255, 255, 0.48);
        }
        .swiper-container{padding-bottom: 0;}
        .search-input input::-webkit-input-placeholder{color: #fff;font-family: SimHei;}
        .search-input input::placeholder{color: #fff;font-family: SimHei;}
        /*==字体图标==*/
        .tab-link{font-family: 'hiragino sans gb w3';}
        .tab-link:after{
            content: '\e611';
            font-family: iconfont-sm!important;
            font-style: normal;
            margin-left: .8rem;
            display: inline-block;
            vertical-align: .05rem;
            background-size: 100% auto;
            background-position: center;
            -webkit-font-smoothing: antialiased;
        }
        @media only screen and (max-width: 320px){
                .tab-link:after{
                margin-left: .7rem;
            }
        }
        .buttons-tab a.button+a:before{
            content: '';
            display: block;
            position: absolute;
            top: .45rem;
            left: 0;
            width: 1px;
            height: 1.1rem;
            background-color: #dcdcdc;
        }
        /*===设置轮播图片大小与控制点===*/
        .swiper-container .swiper-slide img{width: 100%;height: auto;object-fit:cover;}
        .swiper-container .swiper-pagination{
            position: absolute;
            width: 20%;
            bottom: 20px;
        }
        /*==样式覆盖==*/
        /*-按钮及搜索-*/
        .buttons-tab a.button{
            font-size: .75rem;
        }
        .bar{background-color: rgba(0,0,0,0);}
        .bar:after{background-color: rgba(0,0,0,0);}
        .bar .searchbar {
            padding: .4rem 3.25rem;
            background: rgba(0,0,0,0);
        }
        .bar-header-secondary~.content {
            top: 0;
        }
        .bar .searchbar .search-input input{
            border: 1px solid #c4c4c4;
            color: #fff;
        }
        .search-input input{
            font-size: .6rem;
        }
        .search-input .icon{
            color:#fff;
        }
        .icon.icon-search{color: #fff;}
        .buttons-tab .button {color: #666;font-weight: 700;}
        /*-头像及字体-*/
        .commentAvatarDiv,
        .commentAvatarImage{
            width: 65px;
            height: 65px;
            border-radius: 8px;
        }
        .list-block .item-title{
            font-size: .75rem;
            color: #000;
        }
        .list-block .item-subtitle{
            font-size: .65rem;
            line-height: 2em;
        }
        .list-block .item-text{
            height: 20px;
            padding-top: 3px;
            padding-left: 25px;
            margin-top: -3px;
            font-size:.6rem;
            color: #828282;
            background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAjCAYAAADmOUiuAAAD0UlEQVRYhcWYXVLbSBSFz2mgKmBXWfIGwqwA7yC8pIqfBzwrwDuws4J4VhDNCiJWEOchlqr8EM8KolnBiA2AUiWZh5A+8yAkC/8Qm4A5T+7WtfrTVff9EfEbcsL0AELLgPsP2VmZMXdeRddv+X3dNbiOsTtSQ7dZm2KbRHvdxQTElAbWwE+O6v8+GaA7UkM/bzqUegT21wVbJAkDGfjJUe3zbwE6QXpOsD8LJikhObBkBMto6Q2MdYzQktAm0VoMqv4yjz4I2BymH0D25qBk/ORk959fPdwi5Q+MDsHD6rwl2ou8uRSwGWQfAXTKCcmz2vKS093Lx4DNgYbZGS36Va9aqJMc1y9+CegOs0/VQ2Cp1qqbel3Nr8VecrT3dzE2D/1BUvKccABwfVL7E4BfAkmeE066xfieB51w0jWSV8DJ4PA54apqBtl7AP1iXDimBHS+3Lw2xsazBpuAKyErh1JAfH1c+6N8xYY/exXbpcf+OXV1Un8naAwABPadMDsrAXV3YiUl2t7zNg1XcpDl2rToGABwhjdvSDoAQHLwmJz5VEqOap8FxDkL2rkHjaaxiBi8DNpUlEoGAwBGcsqr1iSr3MQJJ113mF43g0zFnDtSwx1m35pBJidIz2dt3SD7bzVClgxzcXBVUeoV28IZ3rwBAN1mZb6l2J61zTd+erDOOo8GFOlJSiQl3HkVAQC3awMJUX59+ppKWyBeNzoQyD1gaMd3c/2r49pfjwV/CrlB+rUoJgwAFB4AAGn9QvQp5Y7UKOAkRAYArt/yexkgiZbz5eb1SwHydlImDBKDaqD2pxfsi4Qad6SGpBLQWuOXgMlx/aLqxeYw/bBpOPyYjIvIAMlLTncv751i2a2OpDwGkb1q2bMBOL8IURKiq5P6O2AmzCSnu5cy7BRjI3nNIPvojtR4LjgnTA9yz01rUMlMY+jCPwXpuQH9YlyUPk8JVvFaCbOoBl0YqJPj+oUl2sXrrmaAdTPBIjAnnHRxO4nuwyGStuZq0JW7OitzCCE2xsZ5taFYgM/t2krVjxNmZ8bqUGS72sLmXmNnWX/8IKA7zL4VG9dSrbvPHP6snaQExJLemPvLmn0JA8n0HuoUlwJWW4BiD1ZT0GMlICYwtpS3Sl7eXnbBGNsvfhPwnXDSpVTA+ZYYGKEFYF9Su4xfC6E0phCt802msva8nDA9MGI1Pw+mYQARdvYON1V1zwFOI/ri7yjY2etssiW4B7gMLj9ppl/t+DelaV8cpOcUvOpeEhCL9Li1679UI0V3pAZ/ZH0RLYJjALBQDCJ6id54Vv8DL/AiZ79I4eoAAAAASUVORK5CYII=);
            background-clip: border-box;
            background-repeat: no-repeat;
            background-position: left bottom .1rem;
            background-size: .8rem .7rem;
            /*background-size: contain;*/
        }
        .list-block.media-list .item-inner{
            padding-top: .6rem;
            padding-bottom: .65rem;
            font-family: SimHei;
            box-sizing: border-box;
        }
        .list-block.media-list .item-media{
            padding-top: .6rem;
            padding-bottom: .65rem;
        }
        .list-block .item-link .item-inner{
            background-size: .575rem .925rem;
            background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAlCAYAAACpmHIGAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo5ZTg3Yzg4Yi04ZmE1LWZkNGEtOWFjYy1jNzU2ZWMzYTQ3ZTAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NkUwMzAxMDk2NkVEMTFFNkFCMTZBNTRBNDIzQkE4RUYiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NkUwMzAxMDg2NkVEMTFFNkFCMTZBNTRBNDIzQkE4RUYiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OWU4N2M4OGItOGZhNS1mZDRhLTlhY2MtYzc1NmVjM2E0N2UwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjllODdjODhiLThmYTUtZmQ0YS05YWNjLWM3NTZlYzNhNDdlMCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Prk437gAAAK4SURBVHjarJZJaBRBFIZ7Oq2inlQwUSFoJILgQWS8CAqCIAhuCKII7kaMW9S44IIKuQjuO+pJ9KDEBQ/izYNLhAyuYDQHRS8mblGDF09+D/6GStsz02N3wceju6r+V/3q1av2vZhWKBRyXgbNL/K+Cgf9MxdHdAjmDCxM6yBu5XOhAfbA/DQO4sSfwnmog71pHPg2EaaGL/L5/EvMKbgI49I4sJXXw0Emr3McvFbcUzkw8W8wHc5GHHSkdeAj0qXN87J2kHNScCvmiB4bET7n9I3HrIc10AktcIsxfxJlCwOPYrZl+QV9UjFrB//keZYOYmtLVg6KFa5MHPilNiStA79crqZxkPhSYMImzAk9bkb4ZMw5WAlWm47BzYpuHESsoG3Q4zQcPHD6hmN2gh3Gd7DFr0C4VqfT2luYEhkyCMLqOhC6ggSiVZharbhBDiwk150x1QrZZLiv8vEmSLDokbAKltpq4LAJM/mnhGsw+2EOfLb6ZMLWF5RZdZ1WbAXruy6R2/BL/RO0eTPgscUc4Yfh/KCE8GiteBl8UcW8zOReZ1iThD9AM31trkZQQrjRWfEhSy0Tps+SYCLsUyhewQF4FtUJIqKBNs8OylroUSiuhTGmDYbdMA+ewxJdi15JcdoIhWIFdGvFrc7mjVUuL9D12FJMuI84E8dgNirdLBSnbfOY/EP99fqKmdo8S7cXpRIiUB2ocdKtW+l2Jdw8jWmW8CeLdznhsHANhV1gtaNXWdEKvyU8CXNHX9Qu+yjJqbawDIPZCsVxuOrEOFCtsBVbbFfrp8lLKm45vENZcMMRtgOyHRbDR6VbRyWFLiehAVZ4EO7R8yjMBZgFT6yUqnZ7FYtHcr0f5pI2175qOcJ3s/rLtdO3CNpk7/3vL3Tc8f+qG6WTFbdn+vOP4Hs77qoZqdpfAQYARmRPLak+tCYAAAAASUVORK5CYII=); 
        }
        .page-group{-webkit-font-smoothing:antialiased;}
        .bar-tab~.content {bottom: 2rem;}
        .bar-tab{height: 2rem;border-top: 1px solid #e7e7e7;box-sizing: border-box;}
        .bar-tab .tab-item{height: 2rem;color: #666;}
        .bar-tab .tab-item:before{
            content: '';
            display: block;
            position: absolute;
            top: .4rem;
            width: 1px;
            height: 1.2rem;
            background-color: #dcdcdc;
        }
        .bar-tab .tab-item.active .tab-label,.bar-tab .tab-label:active{color: #12B7F5;}
        .bar-tab .tab-item.addactive .tab-label{color: #12B7F5;}
        .bar-tab .tab-label{
            display: inline-block;
            padding: .45rem 0 .45rem 1.2rem;
            /*height: 100%;*/
            font-size: .75rem;
            line-height: 1.1rem;
            text-align: left;
            margin-top: -1px;
            /*margin-left: 1rem;*/
            box-sizing: border-box;
        }
        .buy-time,.sell-time,.my-time{background-repeat: no-repeat;background-size: auto 1.1rem;background-position: left center;-webkit-user-select:none;user-select:none;}
        .buy-time{background-image: url(../images/icon/buy-time.png);}
        .sell-time{background-image: url(../images/icon/sell-time.png);}
        .my-time{background-image: url(../images/icon/my-time.png);}
        .tab-item.addactive .buy-time,
        .tab-item.active .buy-time{background-image: url(../images/icon/buy-timing.png);}
        .tab-item.addactive .sell-time,
        .tab-item.active .sell-time{background-image: url(../images/icon/sell-timing.png);}
        .tab-item.addactive .my-time,
        .tab-item.active .my-time{background-image: url(../images/icon/my-timing.png);}
        .buttons-tab .button.active{
        	color: #12b7f5;
    		border-color: #12b7f5;
    	}
        /*--轮播图状态点修改--*/
        .swiper-pagination-bullet{opacity: 1;background: transparent;border: 1px solid #007aff;}
        .swiper-pagination-bullet-active{background: #007aff;}
        /*--修复安卓下划线无法显示--*/
        @media only screen and (-webkit-min-device-pixel-ratio: 2){
               .buttons-tab:after {
                    -webkit-transform: scaleY(1);
                    transform: scaleY(1);
                }
                .list-block ul:before {
                -webkit-transform: scaleY(0);
                transform: scaleY(0);
            }
            .list-block ul:after {
                -webkit-transform: scaleY(1);
                transform: scaleY(1);
            }
        }
        /*--xhsk-log--*/
        .xhsk-fixed-log{position: absolute;z-index: 9;top: 0;right: 0;}
        .xhsk-fixed-log .fixed-log-con{overflow: hidden;}
        .xhsk-fixed-log .fixed-log-con,
        .xhsk-fixed-log img{width:1.7rem;height: 1.7rem;font-size: 12px;}
        .xhsk-fixed-log img{vertical-align: top;}
        .float-btn-div{
            position: fixed;top: 15rem;z-index: 100;right: 0rem;
        }
        .float-btn-div i:active {
            color: #BCEE68;
        }
    </style>
    <script src="//g.alicdn.com/sj/lib/zepto/zepto.min.js"></script>

</head>
<body>
<div class="page-group" >

    <div id="page-swiper" class="page">

        <nav class="bar bar-tab">
            <a class="tab-item active" href="#" id="indexBtn">
                <span class="tab-label buy-time">约</span>
            </a>
            <a class="tab-item" id="bidIndexBtn">
                <span class="tab-label sell-time">飚</span>
            </a>
            <a class="tab-item" href="#" id="myPageBtn">
                <span class="tab-label my-time">我</span>
            </a>
        </nav>

        <div class="content" id=''>
            <!-- 邂逅拾刻log -->
            <div class="xhsk-fixed-log">
                <div class="fixed-log-con">
                    <img src="/time/images/icon/logo.png" alt="邂逅拾刻">
                </div>
            </div>
            <div class="swiper-container"  style="position: relative;padding-bottom: 0px;">
                <div class="swiper-wrapper">

                </div>
                <div class="swiper-pagination" style="position: absolute;right: 0;left: 0;width: 20%;bottom: 20px;margin:0 auto;"></div>
            </div>
            <div class="bar bar-header-secondary" style="top:0;">
                <div class="searchbar">
                    <!--<a class="searchbar-cancel">取消</a>-->
                    <div class="search-input">
                        <label class="icon icon-search" for="search"></label>
                        <form id="searchForm"><input type="search" id='search' name="keyword" placeholder='输入卖家or项目名称'/></form>
                    </div>
                </div>
            </div>
            <div class="buttons-tab">
                <a href="#recommendTab" class="tab-link active button">推荐</a>
                <a href="#newTab" class="tab-link button">最新</a>
                <a href="#hotTab" class="tab-link button">最火</a>
                <a href="#goodTab" class="tab-link button">最优</a>
            </div>
             
                <div class="tabs">
                    <div id="recommendTab" class="tab active infinite-scroll">

                        <div class="list-block media-list" style="margin-top:  0px;">

                        </div>
                        <!-- 加载提示符 -->
                        <div class="infinite-scroll-preloader">
                            <div class="preloader">
                            </div>
                        </div>
                    </div>
                    <div id="newTab" class="tab infinite-scroll">
                        <div class="list-block media-list" style="margin-top:  0px;">

                        </div>
                        <!-- 加载提示符 -->
                        <div class="infinite-scroll-preloader">
                            <div class="preloader">
                            </div>
                        </div>
                    </div>
                    <div id="hotTab" class="tab infinite-scroll">
                        <div class="list-block media-list" style="margin-top:  0px;">

                        </div>
                        <!-- 加载提示符 -->
                        <div class="infinite-scroll-preloader">
                            <div class="preloader">
                            </div>
                        </div>
                    </div>
                    <div id="goodTab" class="tab infinite-scroll">
                        <div class="list-block media-list" style="margin-top:  0px;">

                        </div>
                        <!-- 加载提示符 -->
                        <div class="infinite-scroll-preloader">
                            <div class="preloader">
                            </div>
                        </div>
                    </div>
                </div>

            <a id="floatBtn">
                <div class="float-btn-div">
                    <i class="material-icons fixed" style="font-size: 3rem;">add_circle_outline</i>
                </div>
            </a>

        </div>
    </div>

</div>
<script src="//g.alicdn.com/msui/sm/0.6.2/js/sm.min.js"></script>
<script src="//g.alicdn.com/msui/sm/0.6.2/js/sm-extend.min.js"></script>
<script>
	// setTimeout(startInit, 300);
    function toViewUserItem(userId,itemId){
        window.location.href = "${request.contextPath}/user/to-view-items/"+userId+"/"+itemId;
    }
	    $(document).on("pageInit", function() {
	        var searchHeight = $('.bar-header-secondary').css('height');
	        $('.content').css('top',0);
	        $.showIndicator();
	        //多个标签页下的无限滚动
	        var loading = false;
	        // 每次加载添加多少条目
	        var itemsPerLoad = 10;
	        // 最多可加载的条目
	        var maxItems = 30;
	        var  lastIndex = $('.list-block ul').length;
	        function addItems(number, lastIndex,data,tabId) {
	            // 生成新条目的HTML
	            var html = '';
	            var dataLength = 0;
	            $.each(data, function(i, item){
	                var itemStatus = "";
	                if(item.item.itemStatus == 'for_sale'){
	                    itemStatus = "销售中";
	                }else if(item.item.itemStatus == 'undercarriage'){
	                    itemStatus = "已下架";
	                }else if(item.item.itemStatus == 'draft'){
	                    itemStatus = "草稿";
	                }
	                var headPic = item.headImgPath;
	                if(headPic == '' || headPic == null){
	                    headPic = '${request.contextPath}/images/default_head.jpg';
	                }
	                html += '<ul>'+
	                            '<li>'+
	                                '<a href="#" class="item-link item-content" onclick="toViewUserItem(\''+item.item.userId+'\',\''+item.item.itemId+'\')">'+
	                                    '<div class="item-media">' +
	                                        '<div class="commentAvatarDiv">' +
	                                            '<img class="commentAvatarImage" src="'+headPic+'" />' +
	                                        '</div>' +
	                                    '</div>'+
	                                    '<div class="item-inner">'+
	                                        '<div class="item-title-row">'+
	                                            '<div class="item-title">'+item.item.title+'</div>'+
	                                        '</div>'+
	                                        '<div class="item-subtitle">'+item.item.createUserName+'</div>'+
	                                        '<div class="item-text">'+item.item.useCount+'人咨询过</div>'+
	                                    '</div>'+
	                                '</a>'+
	                            '</li>'+
	                        '</ul>';
	                dataLength += 1;
	            });
	            if(dataLength == 0){
	                $('.no-record').show();
	                $('.infinite-scroll-preloader').remove();
	            }else{
	                $('.no-record').hide();
	                $('.infinite-scroll-preloader').hide();
	                // 添加新条目
	                //$('.active.infinite-scroll .list-block').append(html);
	                $('#'+tabId+'.infinite-scroll .list-block').append(html);
	            }


	        }
	        $.post('${request.contextPath}/item/list-by-condition', {condition:'recommend',startIndex: 0,loadSize:itemsPerLoad}, function (response) {
	            $('#recommendTab.infinite-scroll .list-block').empty();
	            //预先加载20条
	            // new XhskSwiper(response);
	            addItems(itemsPerLoad, 0,response,'recommendTab');
	            $.hideIndicator();
	        });
	        $.post('${request.contextPath}/item/list-by-condition', {condition:'new',startIndex: 0,loadSize:itemsPerLoad}, function (response) {
	            $('#newTab.infinite-scroll .list-block').empty();
	            //预先加载20条
	            addItems(itemsPerLoad, 0,response,'newTab');
	        });
	        $.post('${request.contextPath}/item/list-by-condition', {condition:'hot',startIndex: 0,loadSize:itemsPerLoad}, function (response) {
	            $('#hotTab.infinite-scroll .list-block').empty();
	            //预先加载20条
	            addItems(itemsPerLoad, 0,response,'hotTab');
	        });
	        $.post('${request.contextPath}/item/list-by-condition', {condition:'good',startIndex: 0,loadSize:itemsPerLoad}, function (response) {
	            $('#goodTab.infinite-scroll .list-block').empty();
	            //预先加载20条
	            addItems(itemsPerLoad, 0,response,'goodTab');
	        });
	        $(document).on('infinite', function() {
	            // 如果正在加载，则退出
	            if (loading) return;
	            // 设置flag
	            loading = true;
	            var tabIndex = 0;
	            var dataType = 'recommend';
	            var tabId = $(this).find('.infinite-scroll.active').attr('id');
	            if(tabId == "newTab"){
	                tabIndex = 1;
	                dataType = 'new';
	            }
	            if(tabId == "hotTab"){
	                tabIndex = 2;
	                dataType = 'hot';
	            }
	            if(tabId == "goodTab"){
	                tabIndex = 3;
	                dataType = 'good';
	            }
	            lastIndex = $('.list-block').eq(tabIndex).find('ul').length;
	            $.post('${request.contextPath}/item/list-by-condition', {condition:dataType,startIndex: lastIndex,loadSize:itemsPerLoad}, function (response) {
	                setTimeout(function() {
	                    // 重置加载flag
	                    loading = false;

	                    if (lastIndex >= maxItems) {
	                        // 加载完毕，则注销无限加载事件，以防不必要的加载
	                        $.detachInfiniteScroll($('.infinite-scroll'));
	                        // 删除加载提示符
	                        $('.infinite-scroll-preloader').remove();
	                        return;
	                    }
	                    // 添加新条目
	                    addItems(itemsPerLoad, lastIndex,response,tabId);
	                    // 更新最后加载的序号
	                    lastIndex = $('.list-block ul').length;
	                    //容器发生改变,如果是js滚动，需要刷新滚动
	                    $.refreshScroller();
	                }, 1000);
	            });
	        });
	    });
	    $.post('${request.contextPath}/user/get-remind', function (response) {
	        var remindCount = response.sellRemindCount;
	        if(remindCount > 0){
	            $('.badge').text(remindCount);
	            $('.badge').show();
	        }

	    });
    $("body").on( "click", "#myPageBtn", function(){
        window.location.href = '${request.contextPath}/wx/to-get-open-id';
    } );
    $("body").on( "click", "#bidIndexBtn", function(){
        window.location.href = "${request.contextPath}/bid/to-index";
    } );
    $("body").on( "click", "#indexBtn", function(){
        window.location.href = "${request.contextPath}/index/to-index";
    } );
    $("body").on( "click", "#floatBtn", function(){
        var backUrl = 'http://www.xiehoushike.com'+'${request.contextPath}/item/to-add';
        window.location.href = '${request.contextPath}/wx/to-get-open-id?backUrl='+encodeURIComponent(backUrl);
    } );
	    $("body").on( "submit", "#searchForm", function(){
	        var keyword = $('#search').val();
	        if(keyword == ''){
	            return false;
	        }
	        $('form').attr('action','${request.contextPath}/item/to-search');
	        $('form').submit();
	    } );
</script>
<script>
     function XhskSwiper(datas){
        this.datas=datas || '';
        this.init();
    }
    XhskSwiper.prototype.init=function(){
        this._swiper();
    }
    XhskSwiper.prototype._swiper=function(){
        this.setHtmlDom();
        var $mySwiper = $(".swiper-container").swiper({
            autoplay: 5000,
            loop:true,
            observer:true,
            observeParents:true
        });
        $mySwiper.update(true);
    }
    XhskSwiper.prototype.setHtmlDom=function(){
        var datas=this.datas;
        var html =this.getHtmlDom(datas);
        $('.swiper-wrapper').append(html);
    }
    XhskSwiper.prototype.getHtmlDom=function(datas){
        var htmlDomObj=this._htmlDom(),
            dataLength = datas.length >= 3 ? 3:datas.length,
            headPicArr = [1,2,3],
            html='';
        $(".swiper-wrapper").empty();
        $(".swiper-pagination").empty();
        for(var i = 0; i< 3;i++){
            //var n = Math.floor(Math.random() * headPicArr.length + 1)-1;
            //html += htmlDomObj.a+headPicArr[i]+htmlDomObj.b+datas[i].item.userId+htmlDomObj.c+htmlDomObj.d;
            html += htmlDomObj.a+headPicArr[i]+htmlDomObj.b+htmlDomObj.c+htmlDomObj.d;
        }
        return html;
    }
    XhskSwiper.prototype._htmlDom=function(){
        var htmlDomObj={
            a:'<div class="swiper-slide"><img  src="${request.contextPath}/images/headback',
            b:'.jpg?v=20160902"  style="width: 100%;" ',
            c:'"><div  style="position: absolute;right: 10px;width: 70%;bottom: 20px;z-index: 999;font-weight: bold;color: #ffffff">',
            d:'</div></div>'
        }
        return htmlDomObj;
    }
    $.post('${request.contextPath}/item/list-by-condition', {condition:'recommend',startIndex: 0,loadSize:10}, function (response) {
        new XhskSwiper(response);
            $.init();
        });
</script>
<script>
    // 重写底部botton事件
    $(function(){
        var $arr=$('.tab-item');
        var $len=$arr.length;
        $('.tab-item').each(function(index,ele){
            var $childDOM=$(ele).children('.tab-label');
            $($childDOM).on('touchstart',function(e){
                if($(ele).hasClass('addactive')){
                    return;
                }
                for(var i=0;i<$len;i++){
                    if($($arr[i]).hasClass('active')){
                        $($arr[i]).removeClass('active');
                    }
                    if($($arr[i]).hasClass('addactive')){
                        $($arr[i]).removeClass('addactive');
                    }
                }
                $(ele).addClass('addactive');
            })
        });
        $('.tab-item').each(function(index,ele){
            $(ele).on('touchstart',function(e){
                if($(ele).hasClass('addactive')){
                    return;
                }
                for(var i=0;i<$len;i++){
                    if($($arr[i]).hasClass('active')){
                        $($arr[i]).removeClass('active');
                    }
                    if($($arr[i]).hasClass('addactive')){
                        $($arr[i]).removeClass('addactive');
                    }
                }
                $(ele).addClass('addactive');
            })
        });
    })
</script>
</body>
</html>
